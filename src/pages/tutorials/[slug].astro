---
// src/pages/tutorials/[slug].astro
// Dynamic tutorial page - generates a page for each tutorial
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
//import TutorialLayout from '../../layouts/TutorialLayout.astro';
import TutorialLayout from '../../layouts/TutorialLayout-OptionB.astro';

// Generate static paths for all tutorials
export async function getStaticPaths() {
  const tutorials = await getCollection('tutorials', ({ data }) => {
    // Only include published tutorials (draft: false)
    return !data.draft;
  });

  return tutorials.map(tutorial => ({
    params: { slug: tutorial.slug },
    props: { tutorial },
  }));
}

interface Props {
  tutorial: CollectionEntry<'tutorials'>;
}

const { tutorial } = Astro.props;
const { Content } = await tutorial.render();

// Extract frontmatter data
const {
  title,
  subtitle,
  description,
  publishDate,
  lastModified,
  author,
  difficulty,
  estimatedTime,
  estimatedCost,
  tags,
  series,
  seriesOrder,
  image
} = tutorial.data;
---

<TutorialLayout
  title={title}
  subtitle={subtitle}
  description={description}
  publishDate={publishDate}
  lastModified={lastModified}
  author={author}
  difficulty={difficulty}
  estimatedTime={estimatedTime}
  estimatedCost={estimatedCost}
  tags={tags}
  series={series}
  seriesOrder={seriesOrder}
  image={image}
>
  <Content />
</TutorialLayout>
